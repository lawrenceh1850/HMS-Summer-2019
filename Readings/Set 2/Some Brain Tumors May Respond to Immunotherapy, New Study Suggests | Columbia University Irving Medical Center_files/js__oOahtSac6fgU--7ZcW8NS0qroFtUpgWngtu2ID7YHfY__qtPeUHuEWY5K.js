(function($){var original={path:window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'')+window.location.pathname,query:window.location.search||''},beforeSubmit=Drupal.ajax.prototype.beforeSubmit,beforeSerialize=Drupal.ajax.prototype.beforeSerialize;Drupal.behaviors.viewsAjaxHistory={attach:function(context,settings){var $body=$('body').once('views-ajax-history-first-page-load');if($body.length)settings.viewsAjaxHistory.onloadPageItem=settings.viewsAjaxHistory.renderPageItem}};var parseQueryString=function(query){var args={},pos=query.indexOf('?');if(pos!=-1)query=query.substring(pos+1);var pairs=query.split('&'),pair,key,value;for(var i in pairs)if(typeof(pairs[i])=='string'){pair=pairs[i].split('=');if(pair[0]!='q'&&pair[1]){key=decodeURIComponent(pair[0].replace(/\+/g,' '));value=decodeURIComponent(pair[1].replace(/\+/g,' '));if(/\[\]$/.test(key)){if(!(key in args)){args[key]=[value]}else if(!$.inArray(value,args[key])!==-1)args[key].push(value)}else args[key]=value}};return args},cleanURL=function(url,viewArgs){var args=parseQueryString(url),query=[];if(/\?/.test(Drupal.settings.views.ajax_path))query.push('q='+Drupal.Views.getPath(url));$.each(args,function(name,value){if(name in viewArgs)value=viewArgs[name];if($.isArray(value)){$.merge(query,$.map(value,function(sub){return name+'='+sub}))}else query.push(name+'='+value)});url=url.split('?');return url[0]+(query.length?'?'+query.join('&'):'')},addState=function(options,url){Drupal.settings.viewsAjaxHistory.lastViewDomID=options.data.view_dom_id;$(window).unbind('statechange',loadView);History.pushState(options,document.title,cleanURL(url,options.data));$(window).bind('statechange',loadView)},loadView=function(){var state=History.getState(),options=state.data;if(typeof options.data=='undefined'){var viewsAjaxSettingsKey='views_dom_id:'+Drupal.settings.viewsAjaxHistory.lastViewDomID;if(Drupal.settings.views.ajaxViews.hasOwnProperty(viewsAjaxSettingsKey)){var viewsAjaxSettings=Drupal.settings.views.ajaxViews[viewsAjaxSettingsKey];viewsAjaxSettings.page=Drupal.settings.viewsAjaxHistory.onloadPageItem;options={data:viewsAjaxSettings,url:Drupal.settings.views.ajax_path}}};var $dummy=$('<div class="ajaxHistoryDummy"/>'),settings=$.extend({submit:options.data,setClick:true,event:'click',selector:'.view-dom-id-'+options.data.view_dom_id,progress:{type:'throbber'}},options);new Drupal.ajax(false,$dummy[0],settings);$dummy.trigger('click')};Drupal.ajax.prototype.beforeSerialize=function($element,options){if(options.data.view_name){if($($element).hasClass('ajaxHistoryDummy'))return;options.url=Drupal.settings.views.ajax_path;if($element.is('a'))addState(options,$element.attr('href'))};beforeSerialize.apply(this,arguments)};Drupal.ajax.prototype.beforeSubmit=function(form_values,element,options){if(options.data.view_name){var url=original.path+(/\?/.test(original.path)?'&':'?')+element.formSerialize();$.each(form_values,function(){if(/\[\]$/.test(this.name)){if(!options.data[this.name])options.data[this.name]=[];options.data[this.name].push(this.value)}else options.data[this.name]=this.value});addState(options,url)};for(var i=0;i<arguments[0].length;i++)if(arguments[0][i].name=='page')arguments[0][i].value=0;beforeSubmit.apply(this,arguments)}}(jQuery));;/*})'"*/
(function colaBaseScripts($,Drupal){Drupal.behaviors.colaBaseAnchorFocus={attach:function(context,settings){var gcse=/gsc\.tab/g;jQuery.extend(jQuery.expr[':'],{focusable:function(el,index,selector){var $element=$(el);return $element.is(':input:enabled, a[href], area[href], object, [tabindex]')&&!$element.is(':hidden')}})
function focusOnElement($element){if(!$element.length)return;if(!$element.is(':focusable'))$element.attr('tabindex',-1).on('blur focusout',function(){$(this).removeAttr('tabindex')});$element.focus()};$(document).ready(function(){if(document.location.hash)if(!gcse.test(document.location.hash))focusOnElement($(document.location.hash));$(window).bind('hashchange',function(){var hash="#"+window.location.hash.replace(/^#/,'');if(!gcse.test(hash))focusOnElement($(hash))})})}}}(jQuery,Drupal));;/*})'"*/
